/*
 *
 * Module: Door locking control application.
 *
 * File Name: door_locking_control.c
 *
 * Description: Source file of controlMCU application.
 *
 * Author: Mohamed Khaled.
 *
 */
#define F_CPU 8000000


#include "external_eeprom.h"
#include <util/delay.h>
#include "gpio.h"

void savePassword( uint8* password )
{
	for(uint8 i = 0; i < 5; i++)
	{
		EEPROM_writeByte(0x01 + i, *(password + i));
		_delay_ms(10);
	}
	EEPROM_writeByte(0x01, LOGIC_HIGH);
	_delay_ms(10);
}


int main ( void )
{
	/* Delay to let UART in the other MCU to be initialized */
	EEPROM_init();
	_delay_ms(1);

	uint8 pass[5] = {1,2,3,4,5};
	uint8 savedPassword[5];
	savePassword(pass);

	GPIO_setupPinDirection(PORTC_ID, PIN5_ID, PIN_OUTPUT);

	for (uint8 i = 0; i < 5; i++)
	{
		EEPROM_readByte(0x01, savedPassword + i);
	}
	boolean result = 0x01;
	/* Comparing passwords*/
	for (uint8 i = 0; i < 5; i++)
	{
		if(pass[i] != savedPassword[i])
		{
			result = 0x00;
			break;
		}
	}
	if(result)
	{
		GPIO_writePin(PORTC_ID, PIN5_ID, LOGIC_HIGH);
	}
	while(1)
	{

	}

	return 0;
}

